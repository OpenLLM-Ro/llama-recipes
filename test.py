import numpy as np
import sys

r = {
0: [0.6428571428571428, 0.7321428571428572, 0.5535714285714286, 0.23214285714285715, 0.5, 0.6428571428571429, 0.625, 0.3035714285714286, 0.6607142857142857, 0.4769230769230769, 0.8923076923076924, 0.7692307692307692, 0.6153846153846154, 0.5076923076923077, 0.36923076923076925], 
1: [0.6071428571428571, 0.8035714285714285, 0.5714285714285714, 0.25, 0.4464285714285715, 0.6160714285714286, 0.5892857142857143, 0.3392857142857143, 0.7321428571428571, 0.5538461538461539, 0.9076923076923077, 0.7692307692307692, 0.6, 0.5076923076923077, 0.3692307692307692], 
2: [0.6785714285714286, 0.8571428571428572, 0.5714285714285714, 0.25, 0.3214285714285714, 0.5535714285714285, 0.5892857142857143, 0.32142857142857145, 0.7321428571428571, 0.6153846153846154, 0.8769230769230769, 0.7692307692307692, 0.6, 0.523076923076923, 0.3538461538461538], 
3: [0.6785714285714286, 0.8571428571428572, 0.5714285714285714, 0.23214285714285715, 0.3928571428571428, 0.5357142857142857, 0.5535714285714286, 0.35714285714285715, 0.7321428571428571, 0.6307692307692307, 0.8769230769230769, 0.7538461538461538, 0.6, 0.5076923076923077, 0.3538461538461538 ], 
4: [0.6964285714285714, 0.875, 0.6071428571428572, 0.21428571428571427, 0.39285714285714285, 0.5357142857142857, 0.625, 0.35714285714285715, 0.7321428571428571, 0.6153846153846154, 0.8307692307692308, 0.7461538461538462, 0.6, 0.5076923076923077, 0.36923076923076925], 
5: [0.7142857142857143, 0.875, 0.6071428571428572, 0.23214285714285712, 0.3571428571428571, 0.5357142857142857, 0.6071428571428572, 0.3392857142857143, 0.7321428571428571, 0.6153846153846154, 0.8153846153846154, 0.7384615384615385, 0.6153846153846154, 0.5076923076923077, 0.39999999999999997], 
6: [0.7142857142857143, 0.875, 0.6071428571428572, 0.24999999999999997, 0.3571428571428571, 0.5267857142857143, 0.6071428571428572, 0.35714285714285715, 0.6964285714285714, 0.6461538461538462, 0.8, 0.7230769230769232, 0.6153846153846154, 0.5076923076923077, 0.3846153846153846], 
7: [0.6964285714285714, 0.875, 0.625, 0.24999999999999997, 0.3571428571428571, 0.5178571428571428, 0.6071428571428572, 0.3392857142857143, 0.6964285714285714, 0.6307692307692307, 0.8, 0.7384615384615385, 0.6307692307692307, 0.49230769230769234, 0.3846153846153846], 
8: [0.6964285714285714, 0.875, 0.6071428571428572, 0.24999999999999997, 0.3571428571428571, 0.5178571428571428, 0.6071428571428572, 0.3392857142857143, 0.7321428571428571, 0.6461538461538461, 0.7846153846153847, 0.7076923076923076, 0.6307692307692307, 0.49230769230769234, 0.3846153846153846], 
9: [0.6785714285714285, 0.875, 0.6071428571428572, 0.24999999999999997, 0.3571428571428571, 0.5, 0.6071428571428572, 0.35714285714285715, 0.7142857142857143, 0.6615384615384615, 0.7846153846153846, 0.7076923076923076, 0.6307692307692307, 0.5230769230769231, 0.39999999999999997]
}


def build_r(file):
    with open(file, "r", encoding="utf-8") as f:
        lines = f.readlines()


    rs = []
    for line in lines:
        if line.startswith("{0:"):
           rs.append(eval(line.strip()))
    
    r = {}

    for small_r in rs:
        for k, v in small_r.items():
            if k in r:
                r[k].extend(v)
            else:
                r[k]= v
    
    print(r)
    return r


if __name__ == "__main__":

    from datasets import load_dataset
    import datasets
    ds = load_dataset("uonlp/CulturaX", "ro", streaming=True, split="train")
    ds = ds.take(2)
    for x in ds:
        print(x)
        # sys.exit()
    sys.exit()

    r = build_r("slurm-92201.out")
    for k,v in r.items():
        st = np.mean(np.std(np.array(v).reshape((-1,len(v))), axis=1))
        print("{0}: {1:.4f} | {2:.4f} ---- ".format(k, np.mean(v), st), len(v))
